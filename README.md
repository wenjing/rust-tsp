# rust-tsp

Prototype Rust SDK for the [Trust Spanning Protocol](https://www.trustoverip.org/blog/2023/01/05/the-toip-trust-spanning-protocol/).

# Status

This project is in its initial state. Development is ongoing and interfaces or
structure of the repository are likely to change. Nothing in this repository at
this moment represents a "final design" or to be overriding the Trust Spanning Protocol specification, or indicating a future direction of the Trust Spanning Protocol.

In short, it is not the reference implementation *yet*.

# How to build this project

You will need to install the most recent Rust compiler, by following the
[these instructions](https://www.rust-lang.org/tools/install).

Then, you can use these commands to check out and test the repository:

```sh
git clone https://github.com/wenjing/rust-tsp.git
cd rust-tsp
cargo test
```
To build the documentation, run:
```
cargo doc --workspace --no-deps
```

Right now there are two executables; `create-did-web` and `tcp-broadcast`. These can be executed by using:
```sh
cargo run --bin create-did-web
```
and
```sh
cargo run --bin tcp-broadcast
```

# Organisation of the project folder

At this point in time, this repository is organized using [Cargo workspaces](https://doc.rust-lang.org/book/ch14-03-cargo-workspaces.html). This means that several independent crates are present in this repository, which each have their own `Cargo.toml` file.

* `examples/` contains example programs (listed above).
* `tsp-cesr/` is the crate that provides minimalist CESR encoding/decoding support that is sufficient for generating and parsing TSP messages; to keep complexity to a minimum, we explicitly do not provide a full CESR decoder/encoder.
* `tsp-crypto/` contains the cryptographic core:
   - generating non-confidential messages signed using Ed25519
   - genrating confidential messages encrypted using [HPKE-Auth](https://datatracker.ietf.org/doc/rfc9180/); using DHKEM(X25519, HKDF-SHA256) as asymmetric primitives and ChaCha20/Poly1305 as underlying AEAD encryptiong scheme, and signed using Ed25519 to achieve **non-repudiation** (more precisely "strong receiver-unforgeability under chosen ciphertext" or [RUF-CTXT](https://eprint.iacr.org/2001/079) or [Insider-Auth](https://eprint.iacr.org/2020/1499.pdf).
* `tsp-definitions/` defines several common data structures, traits and error types that are used throughout the project.
* `tsp-transport/` code (built using [tokio](https://tokio.rs/) foundations) for actually sending and receiving data over a transport layer. At present only a `tcp`-based broadcast server is supported as a test platform.
* `tsp-vid/` contains code for handling *verified identifiers* and identities. Currently only an extended form of `did:web` is supported.
* `tsp/` contains the high-level interface that will be presented to the outside world as an SDK; i.e. methods such as `send` and `receive`.

# In-project documentation

To read the documentation, you can open the documentation generated by `cargo doc` for each crate listed above. For eexample, to access the documentation of the `tsp-crypto` crate:

```sh
cd tsp-crypto
cargo doc --no-deps --open
```
Or if you had already followed the build instructions above, simply open `target/doc/tsp_crypto/index.html` in your browser.

In the future, documentation will be available at [docs.rs](https://docs.rs).

# Technical specification

See https://hackmd.io/@2JvzP98CRBm6AyIDDz-2tw/H147MYkjp for the technical specification.
